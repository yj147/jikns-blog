# è¡¨æƒ…é€‰æ‹©å™¨åŠŸèƒ½æ–‡æ¡£

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

è¡¨æƒ…é€‰æ‹©å™¨æ˜¯è¯„è®ºç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦å¢å¼ºåŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·åœ¨è¯„è®ºä¸­è½»æ¾æ’å…¥å„ç§è¡¨æƒ…ç¬¦å·å’Œé¢œæ–‡å­—ï¼Œæå‡è¯„è®ºçš„è¡¨è¾¾åŠ›å’Œè¶£å‘³æ€§ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ­ **ä¸°å¯Œçš„è¡¨æƒ…åº“**
- **ä¸»æµ Emoji** - åŒ…å« 100+ ä¸ªå¸¸ç”¨ Emoji è¡¨æƒ…
- **ç»å…¸é¢œæ–‡å­—** - æ—¥å¼é¢œæ–‡å­—å’Œç½‘ç»œæµè¡Œè¡¨æƒ…
- **æ¨ç‰¹é£æ ¼** - ç¤¾äº¤åª’ä½“å¸¸ç”¨è¡¨æƒ…ç»„åˆ
- **é˜¿é²ç³»åˆ—** - å¯çˆ±çš„é˜¿é²ä¸»é¢˜è¡¨æƒ…

### ğŸ¨ **ç”¨æˆ·ä½“éªŒ**
- **æ™ºèƒ½æ’å…¥** - åœ¨å…‰æ ‡ä½ç½®ç²¾ç¡®æ’å…¥è¡¨æƒ…
- **åˆ†ç±»æµè§ˆ** - æŒ‰ç±»å‹ç»„ç»‡ï¼Œä¾¿äºæŸ¥æ‰¾
- **è¿ç»­é€‰æ‹©** - å¯è¿ç»­é€‰æ‹©å¤šä¸ªè¡¨æƒ…
- **å¿«æ·æ“ä½œ** - æ”¯æŒé”®ç›˜å¿«æ·é”®

### ğŸ“± **å“åº”å¼è®¾è®¡**
- **ç§»åŠ¨ç«¯ä¼˜åŒ–** - é€‚é…è§¦æ‘¸æ“ä½œ
- **è‡ªé€‚åº”å¸ƒå±€** - æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´
- **æ·±è‰²æ¨¡å¼** - å®Œç¾æ”¯æŒæ·±è‰²ä¸»é¢˜

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬æ“ä½œ

1. **æ‰“å¼€é€‰æ‹©å™¨**
   - ç‚¹å‡»è¯„è®ºè¾“å…¥æ¡†å·¦ä¸‹è§’çš„ç¬‘è„¸å›¾æ ‡ ğŸ˜Š

2. **é€‰æ‹©è¡¨æƒ…**
   - ç‚¹å‡»é¡¶éƒ¨æ ‡ç­¾åˆ‡æ¢åˆ†ç±»
   - ç‚¹å‡»ä»»æ„è¡¨æƒ…æ’å…¥åˆ°å…‰æ ‡ä½ç½®

3. **å…³é—­é€‰æ‹©å™¨**
   - ç‚¹å‡»å³ä¸Šè§’çš„ âœ• æŒ‰é’®
   - æŒ‰ ESC é”®
   - ç‚¹å‡»é€‰æ‹©å™¨å¤–éƒ¨åŒºåŸŸ

### å¿«æ·é”®

| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| `ESC` | å…³é—­è¡¨æƒ…é€‰æ‹©å™¨ |
| `Tab` | åœ¨åˆ†ç±»æ ‡ç­¾é—´åˆ‡æ¢ |

## ğŸ“‹ è¡¨æƒ…åˆ†ç±»

### ğŸ˜Š è¡¨æƒ… (Emoji)
åŒ…å«ä¸»æµçš„ Unicode Emoji è¡¨æƒ…ç¬¦å·ï¼š

```
ğŸ˜€ ğŸ˜ƒ ğŸ˜„ ğŸ˜ ğŸ˜† ğŸ˜… ğŸ¤£ ğŸ˜‚ ğŸ™‚ ğŸ™ƒ
ğŸ˜‰ ğŸ˜Š ğŸ˜‡ ğŸ¥° ğŸ˜ ğŸ¤© ğŸ˜˜ ğŸ˜— ğŸ˜š ğŸ˜™
ğŸ˜‹ ğŸ˜› ğŸ˜œ ğŸ¤ª ğŸ˜ ğŸ¤‘ ğŸ¤— ğŸ¤­ ğŸ¤« ğŸ¤”
â¤ï¸ ğŸ§¡ ğŸ’› ğŸ’š ğŸ’™ ğŸ’œ ğŸ–¤ ğŸ¤ ğŸ¤ ğŸ’”
ğŸ‘ ğŸ‘ ğŸ‘Œ ğŸ¤Œ ğŸ¤ âœŒï¸ ğŸ¤ ğŸ¤Ÿ ğŸ¤˜ ğŸ¤™
ğŸ”¥ ğŸ’¯ ğŸ’¢ ğŸ’¥ ğŸ’« ğŸ’¦ ğŸ’¨ ğŸ•³ï¸ ğŸ’£ ğŸ’¤
```

### (Â´âˆ€ï½€) é¢œæ–‡å­— (Kaomoji)
ç»å…¸çš„æ—¥å¼é¢œæ–‡å­—è¡¨æƒ…ï¼š

```
OwO, UwU, (Â´ï½¥Ï‰ï½¥`), (ï¼¾â—¡ï¼¾), (â—•â€¿â—•)
(Â´âˆ€ï½€), (ï¿£â–½ï¿£), (Â´â–½`), (ï¼¾â–½ï¼¾), (â—¡ â€¿ â—¡)
(â•¯Â°â–¡Â°ï¼‰â•¯, â”»â”â”», (ï¾‰â—•ãƒ®â—•)ï¾‰*:ï½¥ï¾Ÿâœ§, (â˜†â–½â˜†)
(âŒâ– _â– ), ( Í¡Â° ÍœÊ– Í¡Â°), Â¯\_(ãƒ„)_/Â¯
```

### (â—•â€¿â—•) æ¨ç‰¹é£æ ¼ (Twitter)
ç¤¾äº¤åª’ä½“æµè¡Œçš„è¡¨æƒ…ç»„åˆï¼š

```
(ï½¡â—•â€¿â—•ï½¡), (â—•â€¿â—•)â™¡, (â—•â€¿â—•)âœ¿, (â—•â€¿â—•)â€
(â—•â€¿â—•)â—, (â—•â€¿â—•)â—‹, (â—•â€¿â—•)â—, (â—•â€¿â—•)â—‡
(â—•â€¿â—•)â™ª, (â—•â€¿â—•)â™«, (â—•â€¿â—•)â™¬, (â—•â€¿â—•)â™­
```

### é˜¿é²~ é˜¿é²ç³»åˆ— (Alu)
å¯çˆ±çš„é˜¿é²ä¸»é¢˜è¡¨æƒ…ï¼š

```
é˜¿é², é˜¿é²é˜¿é², é˜¿é²~, é˜¿é²ï¼, é˜¿é²ï¼Ÿ
é˜¿é²(Â´âˆ€ï½€), é˜¿é²(â—•â€¿â—•), é˜¿é²(Â´â–½ï½€)
é˜¿é²â™ª, é˜¿é²â™«, é˜¿é²â™¬
```

## ğŸ”§ æŠ€æœ¯å®ç°

### ç»„ä»¶æ¶æ„

```tsx
// ä¸»è¦ç»„ä»¶
EmojiPicker.tsx          // è¡¨æƒ…é€‰æ‹©å™¨ä¸»ç»„ä»¶
CommentFormWithEmoji.tsx // é›†æˆè¡¨æƒ…åŠŸèƒ½çš„è¯„è®ºè¡¨å•
CommentForm.tsx          // åŸå§‹è¯„è®ºè¡¨å•ï¼ˆå·²å‡çº§ï¼‰
```

### æ ¸å¿ƒåŠŸèƒ½

#### 1. è¡¨æƒ…æ’å…¥é€»è¾‘

```tsx
const handleEmojiSelect = (emoji: string) => {
  const textarea = textareaRef.current
  if (!textarea) return

  const start = textarea.selectionStart
  const end = textarea.selectionEnd
  const currentContent = formData.content
  
  // åœ¨å…‰æ ‡ä½ç½®æ’å…¥è¡¨æƒ…
  const newContent = currentContent.slice(0, start) + emoji + currentContent.slice(end)
  
  setFormData(prev => ({
    ...prev,
    content: newContent
  }))

  // è®¾ç½®æ–°çš„å…‰æ ‡ä½ç½®
  setTimeout(() => {
    const newCursorPos = start + emoji.length
    textarea.setSelectionRange(newCursorPos, newCursorPos)
    textarea.focus()
  }, 0)
}
```

#### 2. å¤–éƒ¨ç‚¹å‡»æ£€æµ‹

```tsx
useEffect(() => {
  const handleClickOutside = (event: MouseEvent) => {
    if (
      pickerRef.current && 
      !pickerRef.current.contains(event.target as Node) &&
      triggerRef?.current &&
      !triggerRef.current.contains(event.target as Node)
    ) {
      onClose()
    }
  }

  if (isOpen) {
    document.addEventListener('mousedown', handleClickOutside)
  }

  return () => {
    document.removeEventListener('mousedown', handleClickOutside)
  }
}, [isOpen, onClose, triggerRef])
```

#### 3. é”®ç›˜äº‹ä»¶å¤„ç†

```tsx
useEffect(() => {
  const handleEscKey = (event: KeyboardEvent) => {
    if (event.key === 'Escape' && isOpen) {
      onClose()
    }
  }

  document.addEventListener('keydown', handleEscKey)
  return () => document.removeEventListener('keydown', handleEscKey)
}, [isOpen, onClose])
```

## ğŸ¨ æ ·å¼å®šåˆ¶

### CSS ç±»å

```css
/* è¡¨æƒ…é€‰æ‹©å™¨å®¹å™¨ */
.emoji-picker {
  @apply absolute bottom-full left-0 mb-2 w-80 max-w-[90vw] 
         bg-white dark:bg-gray-800 border border-gray-200 
         dark:border-gray-600 rounded-lg shadow-lg z-50;
}

/* è¡¨æƒ…æŒ‰é’® */
.emoji-button {
  @apply p-2 rounded-md transition-all duration-200 hover:scale-110;
}

/* è¡¨æƒ…ç½‘æ ¼ */
.emoji-grid {
  @apply grid grid-cols-8 gap-1 p-3 max-h-64 overflow-y-auto;
}
```

### åŠ¨ç”»æ•ˆæœ

```css
/* å¼¹å‡ºåŠ¨ç”» */
@keyframes slide-in-from-bottom {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in {
  animation: slide-in-from-bottom 0.2s ease-out;
}
```

## ğŸ“± å“åº”å¼é€‚é…

### ç§»åŠ¨ç«¯ä¼˜åŒ–

```tsx
// ç§»åŠ¨ç«¯è¡¨æƒ…å°ºå¯¸è°ƒæ•´
{activeCategory === 'emoji' ? (
  <span className="text-xl">{emoji}</span>
) : (
  <span className="text-xs text-center leading-tight">{emoji}</span>
)}
```

### å±å¹•å°ºå¯¸é€‚é…

```css
/* å°å±å¹•é€‚é… */
@media (max-width: 768px) {
  .emoji-picker {
    width: 90vw;
    max-width: 320px;
  }
  
  .emoji-grid {
    grid-template-columns: repeat(6, 1fr);
  }
}
```

## ğŸ”® æ‰©å±•åŠŸèƒ½

### è®¡åˆ’ä¸­çš„åŠŸèƒ½

1. **è‡ªå®šä¹‰è¡¨æƒ…åŒ…**
   - ç”¨æˆ·ä¸Šä¼ è‡ªå®šä¹‰è¡¨æƒ…
   - è¡¨æƒ…åŒ…ç®¡ç†ç•Œé¢

2. **è¡¨æƒ…æœç´¢**
   - æŒ‰å…³é”®è¯æœç´¢è¡¨æƒ…
   - æ™ºèƒ½æ¨èåŠŸèƒ½

3. **ä½¿ç”¨ç»Ÿè®¡**
   - è®°å½•å¸¸ç”¨è¡¨æƒ…
   - ä¸ªæ€§åŒ–æ¨è

4. **è¡¨æƒ…ååº”**
   - å¯¹è¯„è®ºè¿›è¡Œè¡¨æƒ…ååº”
   - è¡¨æƒ…ç»Ÿè®¡æ˜¾ç¤º

### é›†æˆå»ºè®®

```tsx
// æœªæ¥æ‰©å±•æ¥å£
interface EmojiPickerProps {
  onEmojiSelect: (emoji: string) => void
  customEmojis?: CustomEmoji[]      // è‡ªå®šä¹‰è¡¨æƒ…
  recentEmojis?: string[]           // æœ€è¿‘ä½¿ç”¨
  searchEnabled?: boolean           // æœç´¢åŠŸèƒ½
  categories?: EmojiCategory[]      // è‡ªå®šä¹‰åˆ†ç±»
}
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¡¨æƒ…æ— æ³•æ’å…¥**
   - æ£€æŸ¥ textarea ref æ˜¯å¦æ­£ç¡®ç»‘å®š
   - ç¡®è®¤å…‰æ ‡ä½ç½®è·å–æ­£å¸¸

2. **é€‰æ‹©å™¨ä¸æ˜¾ç¤º**
   - æ£€æŸ¥ z-index å±‚çº§
   - ç¡®è®¤ CSS æ ·å¼åŠ è½½

3. **ç§»åŠ¨ç«¯ä½“éªŒå·®**
   - æ£€æŸ¥è§¦æ‘¸äº‹ä»¶å¤„ç†
   - ç¡®è®¤å“åº”å¼æ ·å¼

### è°ƒè¯•æŠ€å·§

```tsx
// æ·»åŠ è°ƒè¯•ä¿¡æ¯
console.log('Emoji picker state:', {
  isOpen: showEmojiPicker,
  activeCategory,
  cursorPosition: textareaRef.current?.selectionStart
})
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è¯„è®ºç³»ç»Ÿæ€»ä½“æ¶æ„](./COMMENT_SYSTEM.md)
- [è¡¨æƒ…åŒ…è§’è‰²åŠŸèƒ½](./COMMENT_EMOJI_FEATURE.md)
- [ç”¨æˆ·ä½“éªŒä¼˜åŒ–](./UX_OPTIMIZATION.md)
- [ç§»åŠ¨ç«¯é€‚é…æŒ‡å—](./MOBILE_ADAPTATION.md)
