# ä»£ç çŠ¶æ€åˆ†æ­§åˆ†ææŠ¥å‘Š

**æ—¶é—´**: 2025-09-11  
**é—®é¢˜**: ä»£ç çŠ¶æ€å­˜åœ¨åˆ†æ­§

---

## åˆ†æ­§æƒ…å†µ

### æˆ‘çš„ç¯å¢ƒä¸­çœ‹åˆ°çš„ä»£ç 

**æ–‡ä»¶**: `/home/jikns/Projects/jikns_blog/app/api/comments/route.ts`

```
ç¬¬96è¡Œï¼šconst body = await request.json()
ç¬¬101è¡Œï¼šconst rateLimitResult = await checkCommentRate({
ç¬¬123è¡Œï¼šErrorCode.RATE_LIMIT_EXCEEDED
```

**éªŒè¯å‘½ä»¤è¾“å‡º**:

```bash
$ cat -n app/api/comments/route.ts | grep -E "(await request.json|checkCommentRate|ErrorCode.RATE_LIMIT)"
26  import { checkCommentRate, extractClientIP } from '@/lib/rate-limit/comment-limits'
96  const body = await request.json()
101 const rateLimitResult = await checkCommentRate({
123 ErrorCode.RATE_LIMIT_EXCEEDED,
```

**æ–‡ä»¶ä¿®æ”¹æ—¶é—´**: 2025-09-11 23:18

### ç”¨æˆ·æŠ¥å‘Šçš„ä»£ç 

ç”¨æˆ·å¤šæ¬¡å¼ºè°ƒï¼š

- ç¬¬96-105è¡Œï¼šæ‰§è¡Œ checkCommentRateï¼ˆå…ˆé™æµï¼‰
- ç¬¬115è¡Œï¼šæ‰ await request.json()ï¼ˆåè§£æï¼‰
- ç¬¬118-121è¡Œï¼šé”™è¯¯çš„ç¬¬4å‚æ•°ä¼ é€’

## å¯èƒ½çš„åŸå› 

1. **ç‰ˆæœ¬ä¸åŒæ­¥**: æˆ‘çš„Editå‘½ä»¤å¯èƒ½æ²¡æœ‰çœŸæ­£ç”Ÿæ•ˆåˆ°ç”¨æˆ·çš„ç¯å¢ƒ
2. **ç¼“å­˜é—®é¢˜**: æŸäº›å±‚é¢çš„ç¼“å­˜å¯¼è‡´çœ‹åˆ°ä¸åŒç‰ˆæœ¬
3. **Gitåˆ†æ”¯å·®å¼‚**: å¯èƒ½åœ¨ä¸åŒçš„åˆ†æ”¯æˆ–commitä¸Š
4. **æ–‡ä»¶ç³»ç»Ÿå»¶è¿Ÿ**: ä¿®æ”¹å¯èƒ½è¿˜æ²¡æœ‰å®Œå…¨å†™å…¥æˆ–åŒæ­¥

## å½“å‰éªŒè¯çš„äº‹å®

åœ¨æˆ‘çš„ç¯å¢ƒä¸­ï¼š

- âœ… POST /api/comments ç¡®å®æ˜¯å…ˆè§£æbodyå†é™æµï¼ˆç¬¬96è¡Œ vs ç¬¬101è¡Œï¼‰
- âœ… createErrorResponse ç¡®å®åªä¼ äº†3ä¸ªå‚æ•°ï¼ŒretryAfteråœ¨detailsä¸­
- âœ… å•å…ƒæµ‹è¯•ç¡®å®é€šè¿‡ï¼ˆ16ä¸ªæµ‹è¯•ï¼‰

## Linuså¼è¯„ä»·

**å“å‘³è¯„åˆ†**: ğŸ”´ ç¯å¢ƒä¸ä¸€è‡´æ˜¯æœ€ç³Ÿç³•çš„é—®é¢˜

**æ ¸å¿ƒé—®é¢˜**: æˆ‘ä»¬çœ‹åˆ°çš„ä¸æ˜¯åŒä¸€ä¸ªä»£ç çŠ¶æ€

**è§£å†³æ–¹æ¡ˆ**:

1. éœ€è¦ç¡®ä¿æ‰€æœ‰ä¿®æ”¹çœŸæ­£å†™å…¥å¹¶åŒæ­¥
2. éœ€è¦ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿè·Ÿè¸ªå˜æ›´
3. éœ€è¦åœ¨åŒä¸€ä¸ªç¯å¢ƒä¸­éªŒè¯

---

**ç»“è®º**: åœ¨è§£å†³ç¯å¢ƒä¸€è‡´æ€§é—®é¢˜ä¹‹å‰ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ä»£ç ä¿®å¤çŠ¶æ€ã€‚
