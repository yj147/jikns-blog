# 现代化博客与社交动态平台 需求文档

**版本**: 4.0 (Final, Aligned with Arch-v4.0) **基准**: 本文档的功能需求严格基于
**《架构设计文档 v4.0》** 进行定义。

**项目简介**

本项目旨在为您打造一个集专业内容发布与社区互动于一体的现代化平台。它包含两大核心模块：

1.  **博客模块**: 一个功能强大、界面现代化且由您作为唯一管理员进行内容管理的专业博客。
2.  **动态模块**: 一个类似微博、朋友圈的社交空间，所有注册用户都可以在这里发布短内容、进行互动。

---

## 1. 用户角色与权限

### 1.1. 管理员 (您)

- **角色定义**: 博客内容的唯一创作者和管理者，同时也是整个平台的最高权限拥有者。
- **核心权限**:
  - 拥有普通用户的所有权限。
  - 对**博客模块**拥有全部 CRUD 权限。
  - 对平台所有内容拥有审核和删除权限。
  - 拥有用户管理权限。

### 1.2. 注册用户

- **角色定义**: 通过任一方式（GitHub 或 邮箱/密码）登录的普通用户。
- **核心权限**:
  - 可以浏览所有公开的博客文章和动态。
  - 可以对自己和其他用户的**博客文章**和**动态**进行评论和点赞。
  - 可以发布、删除自己的**动态**。
  - 可以管理自己的个人资料。

### 1.3. 访客 (未登录)

- **角色定义**: 未登录的用户。
- **核心权限**:
  - 只能浏览公开的博客文章和动态。
  - 不能进行任何互动操作。

---

## 2. 功能需求 (当前版本)

### 2.1. 核心功能

- **用户系统**: 支持双重认证（GitHub + 邮箱/密码），提供个人资料管理和密码重置功能。
  - **个人资料管理**: 用户可以管理自己的个人资料，具体字段包括：
    - `name`: 用户昵称 (必填)
    - `avatarUrl`: 用户头像 URL (可选)
    - `bio`: 个人简介 (可选, 支持长文本)
    - `socialLinks`: 社交链接 (可选, 支持多个，例如个人主页、GitHub 等)

### 2.2. 博客模块 (Blog Module)

- **后台管理 (管理员)**: 文章 CRUD、**文章标签 (Tags)**、文章系列、内容置顶、SEO
  (Canonical URL)、评论管理。
- **前台展示 (所有用户)**: 文章列表/详情页（含系列）、**按标签/月份归档**、评论、点赞、收藏。

### 2.3. 动态模块 (Activity Feed Module)

- **核心功能 (注册用户)**:
  - **发布动态**: 用户可以发布包含文本和图片（可选，支持多图）的短内容。
  - **关注用户**: 用户之间可以互相关注。
  - **动态信息流**: 提供“推荐”和“关注”两种信息流模式。
    - **“关注” Feed**: 按时间倒序显示所关注用户的动态。
    - **“推荐” Feed**: 在项目初期，按时间倒序显示所有公开动态。
  - **置顶内容**: 用户可以将自己的某条动态在个人主页置顶。
- **互动功能 (注册用户)**: 对“动态”进行评论和点赞。

### 2.4. 管理员专属功能

- **统一后台仪表盘**: 提供一个集中的后台管理界面，包含以下核心管理功能：
  - **内容管理**:
    - **动态管理**: 管理员有权删除平台内任何不当的**动态**。
  - **用户管理**:
    - **查看用户列表**: 查看所有注册用户及其角色和状态。
    - **变更用户角色**: 提升或撤销用户的管理员 (`ADMIN`) 身份。
    - **变更用户状态**: 封禁 (`BANNED`) 或解封 (`ACTIVE`) 用户。
    - **删除用户账号**: 可删除用户账号。被删除用户的历史内容（如文章、动态）将被保留，但作者会显示为“已注销用户”。

---

## 3. 后续迭代功能规划 (Planned Future Features)

以下功能已被正式纳入项目路线图，将在核心版本发布后作为紧邻的迭代目标进行开发。

- **通知系统**:
  - **功能**: 当用户的动态/评论被回复、被点赞，或被`@`时，会收到站内信通知。
  - **@提及**: 在“动态”或“评论”中，可以使用 `@用户名`
    的方式提及其他用户并触发通知。
- **邮件订阅 (Newsletter)**:
  - **功能**: 允许访客或用户订阅博客。当管理员发布新文章时，系统会自动向所有订阅者发送邮件通知。

---

## 4. 非功能性需求

- **性能**: 架构设计已充分考虑性能问题。
  - **信息流**: 初期采用“读时拉取”模式，并已规划未来向“写时扇出”模式演进的路径，以应对用户规模增长。
  - **计数**: 初期采用实时聚合查询。当性能需要时，可平滑升级至“缓存计数器”模式。
  - **缓存**: 已预留引入 Redis 等专用缓存层的能力，用于缓存热门文章、标签云等高频访问数据。
- **安全性**: 遵循行业最佳实践，防止 SQL 注入、XSS 攻击等常见 Web 漏洞。所有用户输入都必须经过严格的清理和验证。
- **可扩展性**: 采用模块化和通用化数据模型设计，核心业务逻辑与底层服务（如 Supabase）适度解耦，为未来的功能扩展和技术栈迁移提供保障。
- **SEO 优化**: 必须实现全面的 SEO 功能，包括但不限于：
  - 为每个页面生成唯一的、描述性的 `title` 和 `meta description`。
  - 自动生成并提交 `sitemap.xml`。
  - 使用 `robots.txt` 控制爬虫行为。
  - 支持 `canonical` URL，避免重复内容问题。
  - （推荐）为核心内容（如博客文章）生成结构化数据 (Structured Data)。
