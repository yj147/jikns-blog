/**
 * Slug 生成和去重工具函数
 * 支持中文内容的 URL 友好化处理
 */

/**
 * Slug 生成选项
 */
export interface SlugOptions {
  maxLength?: number
  separator?: string
  lowercase?: boolean
  strict?: boolean // 严格模式：只保留字母数字和分隔符
}

/**
 * 中文拼音映射（常用汉字）
 */
const pinyinMap: Record<string, string> = {
  的: "de",
  一: "yi",
  是: "shi",
  在: "zai",
  不: "bu",
  了: "le",
  有: "you",
  和: "he",
  人: "ren",
  这: "zhe",
  中: "zhong",
  大: "da",
  为: "wei",
  上: "shang",
  个: "ge",
  国: "guo",
  我: "wo",
  以: "yi",
  要: "yao",
  他: "ta",
  时: "shi",
  来: "lai",
  用: "yong",
  们: "men",
  生: "sheng",
  到: "dao",
  作: "zuo",
  地: "di",
  于: "yu",
  出: "chu",
  就: "jiu",
  分: "fen",
  对: "dui",
  成: "cheng",
  会: "hui",
  可: "ke",
  主: "zhu",
  发: "fa",
  年: "nian",
  动: "dong",
  同: "tong",
  工: "gong",
  也: "ye",
  能: "neng",
  下: "xia",
  过: "guo",
  子: "zi",
  说: "shuo",
  产: "chan",
  种: "zhong",
  面: "mian",
  而: "er",
  方: "fang",
  后: "hou",
  多: "duo",
  定: "ding",
  行: "xing",
  学: "xue",
  法: "fa",
  所: "suo",
  民: "min",
  得: "de",
  经: "jing",
  十: "shi",
  三: "san",
  之: "zhi",
  进: "jin",
  着: "zhe",
  等: "deng",
  部: "bu",
  度: "du",
  家: "jia",
  电: "dian",
  力: "li",
  里: "li",
  如: "ru",
  水: "shui",
  化: "hua",
  高: "gao",
  自: "zi",
  二: "er",
  理: "li",
  起: "qi",
  小: "xiao",
  物: "wu",
  现: "xian",
  实: "shi",
  加: "jia",
  量: "liang",
  都: "dou",
  两: "liang",
  体: "ti",
  制: "zhi",
  机: "ji",
  当: "dang",
  使: "shi",
  点: "dian",
  从: "cong",
  业: "ye",
  本: "ben",
  去: "qu",
  把: "ba",
  性: "xing",
  好: "hao",
  应: "ying",
  开: "kai",
  它: "ta",
  合: "he",
  还: "hai",
  因: "yin",
  由: "you",
  其: "qi",
  些: "xie",
  然: "ran",
  前: "qian",
  外: "wai",
  天: "tian",
  政: "zheng",
  四: "si",
  日: "ri",
  那: "na",
  社: "she",
  义: "yi",
  事: "shi",
  平: "ping",
  形: "xing",
  相: "xiang",
  全: "quan",
  表: "biao",
  间: "jian",
  样: "yang",
  与: "yu",
  关: "guan",
  各: "ge",
  重: "zhong",
  新: "xin",
  线: "xian",
  内: "nei",
  数: "shu",
  正: "zheng",
  心: "xin",
  反: "fan",
  你: "ni",
  明: "ming",
  看: "kan",
  原: "yuan",
  又: "you",
  么: "me",
  利: "li",
  比: "bi",
  或: "huo",
  但: "dan",
  质: "zhi",
  气: "qi",
  第: "di",
  向: "xiang",
  道: "dao",
  命: "ming",
  此: "ci",
  变: "bian",
  条: "tiao",
  只: "zhi",
  没: "mei",
  结: "jie",
  解: "jie",
  问: "wen",
  意: "yi",
  建: "jian",
  月: "yue",
  公: "gong",
  无: "wu",
  系: "xi",
  军: "jun",
  很: "hen",
  情: "qing",
  者: "zhe",
  最: "zui",
  立: "li",
  代: "dai",
  想: "xiang",
  佳: "jia",
  已: "yi",
  通: "tong",
  并: "bing",
  提: "ti",
  直: "zhi",
  题: "ti",
  党: "dang",
  程: "cheng",
  展: "zhan",
  五: "wu",
  果: "guo",
  料: "liao",
  象: "xiang",
  员: "yuan",
  革: "ge",
  位: "wei",
  入: "ru",
  常: "chang",
  文: "wen",
  总: "zong",
  次: "ci",
  品: "pin",
  式: "shi",
  活: "huo",
  设: "she",
  及: "ji",
  管: "guan",
  特: "te",
  件: "jian",
  长: "chang",
  求: "qiu",
  老: "lao",
  头: "tou",
  基: "ji",
  资: "zi",
  边: "bian",
  流: "liu",
  路: "lu",
  级: "ji",
  少: "shao",
  图: "tu",
  山: "shan",
  统: "tong",
  接: "jie",
  知: "zhi",
  较: "jiao",
  将: "jiang",
  组: "zu",
  见: "jian",
  计: "ji",
  别: "bie",
  她: "ta",
  手: "shou",
  角: "jiao",
  期: "qi",
  根: "gen",
  论: "lun",
  运: "yun",
  农: "nong",
  指: "zhi",
  几: "ji",
  九: "jiu",
  区: "qu",
  强: "qiang",
  放: "fang",
  决: "jue",
  西: "xi",
  被: "bei",
  干: "gan",
  做: "zuo",
  必: "bi",
  战: "zhan",
  先: "xian",
  回: "hui",
  则: "ze",
  任: "ren",
  取: "qu",
  据: "ju",
  处: "chu",
  队: "dui",
  南: "nan",
  给: "gei",
  色: "se",
  光: "guang",
  门: "men",
  即: "ji",
  保: "bao",
  治: "zhi",
  北: "bei",
  造: "zao",
  百: "bai",
  规: "gui",
  热: "re",
  领: "ling",
  七: "qi",
  海: "hai",
  口: "kou",
  东: "dong",
  导: "dao",
  器: "qi",
  压: "ya",
  志: "zhi",
  世: "shi",
  金: "jin",
  增: "zeng",
  争: "zheng",
  济: "ji",
  阶: "jie",
  油: "you",
  思: "si",
  术: "shu",
  极: "ji",
  交: "jiao",
  受: "shou",
  联: "lian",
  什: "shen",
  认: "ren",
  六: "liu",
  共: "gong",
  权: "quan",
  收: "shou",
  证: "zheng",
  改: "gai",
  清: "qing",
  美: "mei",
  再: "zai",
  采: "cai",
  转: "zhuan",
  更: "geng",
  单: "dan",
  风: "feng",
  切: "qie",
  打: "da",
  白: "bai",
  教: "jiao",
  速: "su",
  花: "hua",
  带: "dai",
  安: "an",
  场: "chang",
  身: "shen",
  车: "che",
  例: "li",
  真: "zhen",
  务: "wu",
  具: "ju",
  万: "wan",
  每: "mei",
  目: "mu",
  至: "zhi",
  达: "da",
  走: "zou",
  积: "ji",
  示: "shi",
  议: "yi",
  声: "sheng",
  报: "bao",
  斗: "dou",
  完: "wan",
  类: "lei",
  八: "ba",
  离: "li",
  华: "hua",
  名: "ming",
  确: "que",
  才: "cai",
  科: "ke",
  张: "zhang",
  信: "xin",
  马: "ma",
  节: "jie",
  话: "hua",
  米: "mi",
  整: "zheng",
  空: "kong",
  元: "yuan",
  况: "kuang",
  今: "jin",
  集: "ji",
  温: "wen",
  传: "chuan",
  土: "tu",
  许: "xu",
  步: "bu",
  群: "qun",
  广: "guang",
  石: "shi",
  记: "ji",
  需: "xu",
  段: "duan",
  研: "yan",
  界: "jie",
  拉: "la",
  林: "lin",
  律: "lv",
  叫: "jiao",
  且: "qie",
  究: "jiu",
  观: "guan",
  越: "yue",
  织: "zhi",
  装: "zhuang",
  影: "ying",
  算: "suan",
  低: "di",
  持: "chi",
  音: "yin",
  众: "zhong",
  书: "shu",
  布: "bu",
  复: "fu",
  容: "rong",
  儿: "er",
  须: "xu",
  际: "ji",
  商: "shang",
  非: "fei",
  验: "yan",
  连: "lian",
  断: "duan",
  深: "shen",
  难: "nan",
  近: "jin",
  矿: "kuang",
  千: "qian",
  周: "zhou",
  委: "wei",
  素: "su",
  技: "ji",
  备: "bei",
  半: "ban",
  办: "ban",
  青: "qing",
  省: "sheng",
  列: "lie",
  习: "xi",
  响: "xiang",
  约: "yue",
  支: "zhi",
  般: "ban",
  史: "shi",
  感: "gan",
  劳: "lao",
  便: "bian",
  团: "tuan",
  往: "wang",
  酸: "suan",
  历: "li",
  市: "shi",
  克: "ke",
  何: "he",
  除: "chu",
  消: "xiao",
  构: "gou",
  府: "fu",
  称: "cheng",
  太: "tai",
  准: "zhun",
  精: "jing",
  值: "zhi",
  号: "hao",
  率: "lv",
  族: "zu",
  维: "wei",
  划: "hua",
  选: "xuan",
  标: "biao",
  写: "xie",
  存: "cun",
  候: "hou",
  毛: "mao",
  亲: "qin",
  快: "kuai",
  效: "xiao",
  斯: "si",
  院: "yuan",
  查: "cha",
  江: "jiang",
  型: "xing",
  眼: "yan",
  王: "wang",
  按: "an",
  格: "ge",
  养: "yang",
  易: "yi",
  置: "zhi",
  派: "pai",
  层: "ceng",
  片: "pian",
  始: "shi",
  却: "que",
  专: "zhuan",
  状: "zhuang",
  育: "yu",
  厂: "chang",
  京: "jing",
  识: "shi",
  适: "shi",
  属: "shu",
  圆: "yuan",
  包: "bao",
  火: "huo",
  住: "zhu",
  调: "diao",
  满: "man",
  县: "xian",
  局: "ju",
  照: "zhao",
  参: "can",
  红: "hong",
  细: "xi",
  引: "yin",
  听: "ting",
  该: "gai",
  铁: "tie",
  价: "jia",
  严: "yan",
  首: "shou",
  底: "di",
  液: "ye",
  官: "guan",
  德: "de",
  随: "sui",
  病: "bing",
  苏: "su",
  失: "shi",
  尔: "er",
  死: "si",
  讲: "jiang",
  配: "pei",
  女: "nv",
  黄: "huang",
  推: "tui",
  显: "xian",
  谈: "tan",
  罪: "zui",
  神: "shen",
  艺: "yi",
  呢: "ne",
  席: "xi",
  含: "han",
  企: "qi",
  望: "wang",
  密: "mi",
  批: "pi",
  营: "ying",
  项: "xiang",
  防: "fang",
  举: "ju",
  球: "qiu",
  英: "ying",
  氧: "yang",
  势: "shi",
  告: "gao",
  李: "li",
  台: "tai",
  落: "luo",
  木: "mu",
  帮: "bang",
  轮: "lun",
  破: "po",
  亚: "ya",
  师: "shi",
  围: "wei",
  注: "zhu",
  远: "yuan",
  字: "zi",
  材: "cai",
  排: "pai",
  供: "gong",
  河: "he",
  态: "tai",
  封: "feng",
  另: "ling",
  施: "shi",
  减: "jian",
  树: "shu",
  溶: "rong",
  怎: "zen",
  止: "zhi",
  案: "an",
  言: "yan",
  士: "shi",
  均: "jun",
  武: "wu",
  固: "gu",
  叶: "ye",
  鱼: "yu",
  波: "bo",
  视: "shi",
  仅: "jin",
  费: "fei",
  紧: "jin",
  爱: "ai",
  左: "zuo",
  章: "zhang",
  早: "zao",
  朝: "zhao",
  害: "hai",
  续: "xu",
  轻: "qing",
  服: "fu",
  试: "shi",
  食: "shi",
  充: "chong",
  兵: "bing",
  源: "yuan",
  判: "pan",
  护: "hu",
  司: "si",
  足: "zu",
  某: "mou",
  练: "lian",
  差: "cha",
  致: "zhi",
  板: "ban",
  田: "tian",
  降: "jiang",
  黑: "hei",
  犯: "fan",
  负: "fu",
  击: "ji",
  范: "fan",
  继: "ji",
  兴: "xing",
  似: "si",
  余: "yu",
  坚: "jian",
  曲: "qu",
  输: "shu",
  修: "xiu",
  故: "gu",
  城: "cheng",
  夫: "fu",
  够: "gou",
  送: "song",
  笔: "bi",
  船: "chuan",
  占: "zhan",
  右: "you",
  财: "cai",
  吃: "chi",
  富: "fu",
  春: "chun",
  职: "zhi",
  觉: "jue",
  汉: "han",
  画: "hua",
  功: "gong",
  巴: "ba",
  跟: "gen",
  虽: "sui",
  杂: "za",
  飞: "fei",
  检: "jian",
  吸: "xi",
  助: "zhu",
  升: "sheng",
  阳: "yang",
  互: "hu",
  初: "chu",
  创: "chuang",
  抗: "kang",
  考: "kao",
  投: "tou",
  坏: "huai",
  策: "ce",
  古: "gu",
  径: "jing",
  换: "huan",
  未: "wei",
  跑: "pao",
  留: "liu",
  钢: "gang",
  曾: "ceng",
  端: "duan",
  责: "ze",
  站: "zhan",
  简: "jian",
  述: "shu",
  钱: "qian",
  副: "fu",
  尽: "jin",
  帝: "di",
  射: "she",
  草: "cao",
  冲: "chong",
  承: "cheng",
  独: "du",
  令: "ling",
  限: "xian",
  阿: "a",
  宣: "xuan",
  环: "huan",
  双: "shuang",
  请: "qing",
  超: "chao",
  微: "wei",
  让: "rang",
  控: "kong",
  州: "zhou",
  良: "liang",
  轴: "zhou",
  找: "zhao",
  否: "fou",
  纪: "ji",
  益: "yi",
  依: "yi",
  优: "you",
  顶: "ding",
  础: "chu",
  载: "zai",
  倒: "dao",
  房: "fang",
  突: "tu",
  坐: "zuo",
  粉: "fen",
  敌: "di",
  略: "lue",
  客: "ke",
  袁: "yuan",
  冷: "leng",
  胜: "sheng",
  绝: "jue",
  析: "xi",
  块: "kuai",
  剂: "ji",
  测: "ce",
  丝: "si",
  协: "xie",
  诉: "su",
  念: "nian",
  陈: "chen",
  仍: "reng",
  罗: "luo",
  盐: "yan",
  友: "you",
  洋: "yang",
  错: "cuo",
  苦: "ku",
  夜: "ye",
  刑: "xing",
  移: "yi",
  频: "pin",
  逐: "zhu",
  靠: "kao",
  混: "hun",
  母: "mu",
  短: "duan",
  皮: "pi",
  终: "zhong",
  聚: "ju",
  汽: "qi",
  村: "cun",
  云: "yun",
  哪: "na",
  既: "ji",
  距: "ju",
  卫: "wei",
  停: "ting",
  烈: "lie",
  央: "yang",
  察: "cha",
  烧: "shao",
  迅: "xun",
  境: "jing",
  若: "ruo",
  印: "yin",
  洲: "zhou",
  刻: "ke",
  括: "kuo",
  激: "ji",
  孔: "kong",
  搞: "gao",
  甚: "shen",
  室: "shi",
  待: "dai",
  核: "he",
  校: "xiao",
  散: "san",
  侵: "qin",
  吧: "ba",
  甲: "jia",
  游: "you",
  久: "jiu",
  菜: "cai",
  味: "wei",
  旧: "jiu",
  模: "mo",
  湖: "hu",
  货: "huo",
  损: "sun",
  预: "yu",
  阻: "zu",
  毫: "hao",
  普: "pu",
  稳: "wen",
  乙: "yi",
  妈: "ma",
  植: "zhi",
  息: "xi",
  扩: "kuo",
  银: "yin",
  语: "yu",
  挥: "hui",
  酒: "jiu",
  守: "shou",
  拿: "na",
  序: "xu",
  纸: "zhi",
  医: "yi",
  缺: "que",
  雨: "yu",
  吗: "ma",
  针: "zhen",
  刘: "liu",
  啊: "a",
  急: "ji",
  唱: "chang",
  误: "wu",
  训: "xun",
  愿: "yuan",
  审: "shen",
  附: "fu",
  获: "huo",
  茶: "cha",
  鲜: "xian",
  粮: "liang",
  斤: "jin",
  孩: "hai",
  脱: "tuo",
  硫: "liu",
  肥: "fei",
  善: "shan",
  龙: "long",
  演: "yan",
  父: "fu",
  渐: "jian",
  血: "xue",
  欢: "huan",
  械: "xie",
  掌: "zhang",
  歌: "ge",
  沙: "sha",
  刚: "gang",
  攻: "gong",
  谓: "wei",
  盾: "dun",
  讨: "tao",
  晚: "wan",
  粒: "li",
  乱: "luan",
  燃: "ran",
  矛: "mao",
  乎: "hu",
  杀: "sha",
  药: "yao",
  宁: "ning",
  鲁: "lu",
  贵: "gui",
  钟: "zhong",
  煤: "mei",
  读: "du",
  班: "ban",
  伯: "bo",
  香: "xiang",
  介: "jie",
  迫: "po",
  句: "ju",
  丰: "feng",
  培: "pei",
  握: "wo",
  兰: "lan",
  担: "dan",
  弦: "xian",
  蛋: "dan",
  沉: "chen",
  假: "jia",
  穿: "chuan",
  执: "zhi",
  答: "da",
  乐: "le",
  谁: "shei",
  顺: "shun",
  烟: "yan",
  缩: "suo",
  征: "zheng",
  脸: "lian",
  喜: "xi",
  松: "song",
  脚: "jiao",
  困: "kun",
  异: "yi",
  免: "mian",
  背: "bei",
  星: "xing",
  福: "fu",
  买: "mai",
  染: "ran",
  井: "jing",
  概: "gai",
  慢: "man",
  怕: "pa",
  磁: "ci",
  倍: "bei",
  祖: "zu",
  皇: "huang",
  促: "cu",
  静: "jing",
  补: "bu",
  评: "ping",
  翻: "fan",
  肉: "rou",
  践: "jian",
  尼: "ni",
  衣: "yi",
  宽: "kuan",
  扬: "yang",
  棉: "mian",
  希: "xi",
  伤: "shang",
  操: "cao",
  垂: "chui",
  秋: "qiu",
  宜: "yi",
  氢: "qing",
  套: "tao",
  督: "du",
  振: "zhen",
  架: "jia",
  亮: "liang",
  末: "mo",
  宪: "xian",
  庆: "qing",
  编: "bian",
  牛: "niu",
  触: "chu",
  映: "ying",
  雷: "lei",
  销: "xiao",
  诗: "shi",
  座: "zuo",
  居: "ju",
  抓: "zhua",
  裂: "lie",
  胞: "bao",
  呼: "hu",
  娘: "niang",
  景: "jing",
  威: "wei",
  绿: "lv",
  晶: "jing",
  厚: "hou",
  盟: "meng",
  衡: "heng",
  鸡: "ji",
  孙: "sun",
  延: "yan",
  危: "wei",
  胶: "jiao",
  屋: "wu",
  乡: "xiang",
  临: "lin",
  陆: "lu",
  顾: "gu",
  掉: "diao",
  呀: "ya",
  灯: "deng",
  岁: "sui",
  措: "cuo",
  束: "shu",
  耐: "nai",
  剧: "ju",
  玉: "yu",
  赵: "zhao",
  跳: "tiao",
  哥: "ge",
  季: "ji",
  课: "ke",
  凯: "kai",
  胡: "hu",
  额: "e",
  款: "kuan",
  绍: "shao",
  卷: "juan",
  齐: "qi",
  伟: "wei",
  蒸: "zheng",
  殖: "zhi",
  永: "yong",
  宗: "zong",
  苗: "miao",
  川: "chuan",
  炉: "lu",
  岩: "yan",
  弱: "ruo",
  零: "ling",
  杨: "yang",
  奏: "zou",
  沿: "yan",
  露: "lu",
  杆: "gan",
  探: "tan",
  滑: "hua",
  镇: "zhen",
  饭: "fan",
  浓: "nong",
  航: "hang",
  怀: "huai",
  赶: "gan",
  库: "ku",
  夺: "duo",
  伊: "yi",
  灵: "ling",
  税: "shui",
  途: "tu",
  灭: "mie",
  赛: "sai",
  归: "gui",
  召: "zhao",
  鼓: "gu",
  播: "bo",
  盘: "pan",
  裁: "cai",
  险: "xian",
  康: "kang",
  唯: "wei",
  录: "lu",
  菌: "jun",
  纯: "chun",
  借: "jie",
  糖: "tang",
  盖: "gai",
  横: "heng",
  符: "fu",
  私: "si",
  努: "nu",
  堂: "tang",
  域: "yu",
  枪: "qiang",
  润: "run",
  幅: "fu",
  哈: "ha",
  竟: "jing",
  熟: "shu",
  虫: "chong",
  泽: "ze",
  脑: "nao",
  壤: "rang",
  碳: "tan",
  欧: "ou",
  遍: "bian",
  侧: "ce",
  寨: "zhai",
  敢: "gan",
  彻: "che",
  虑: "lv",
  斜: "xie",
  薄: "bao",
  庭: "ting",
  纳: "na",
  弹: "dan",
  饲: "si",
  伸: "shen",
  折: "zhe",
  麦: "mai",
  湿: "shi",
  暗: "an",
  荷: "he",
  瓦: "wa",
  塞: "sai",
  床: "chuang",
  筑: "zhu",
  恶: "e",
  户: "hu",
  访: "fang",
  塔: "ta",
  奇: "qi",
  透: "tou",
  梁: "liang",
  刀: "dao",
  旋: "xuan",
  迹: "ji",
  卡: "ka",
  氯: "lv",
  遇: "yu",
  份: "fen",
  毒: "du",
  泥: "ni",
  退: "tui",
  洗: "xi",
  摆: "bai",
  灰: "hui",
  彩: "cai",
  卖: "mai",
  耗: "hao",
  夏: "xia",
  择: "ze",
  忙: "mang",
  铜: "tong",
  献: "xian",
  硬: "ying",
  予: "yu",
  繁: "fan",
  圈: "quan",
  雪: "xue",
  函: "han",
  亦: "yi",
  抽: "chou",
  篇: "pian",
  阵: "zhen",
  阴: "yin",
  丁: "ding",
  尺: "chi",
  追: "zhui",
  堆: "dui",
  雄: "xiong",
  迎: "ying",
  泛: "fan",
  爸: "ba",
  楼: "lou",
  避: "bi",
  谋: "mou",
  吨: "dun",
  野: "ye",
  猪: "zhu",
  旗: "qi",
  累: "lei",
  偏: "pian",
  典: "dian",
  馆: "guan",
  索: "suo",
  秦: "qin",
  脂: "zhi",
  潮: "chao",
  爷: "ye",
  豆: "dou",
  忽: "hu",
  托: "tuo",
  惊: "jing",
  塑: "su",
  遗: "yi",
  愈: "yu",
  朱: "zhu",
  替: "ti",
  纤: "xian",
  粗: "cu",
  倾: "qing",
  尚: "shang",
  痛: "tong",
  楚: "chu",
  谢: "xie",
  奋: "fen",
  购: "gou",
  磨: "mo",
  君: "jun",
  池: "chi",
  旁: "pang",
  碎: "sui",
  骨: "gu",
  监: "jian",
  捕: "bu",
  弟: "di",
  暴: "bao",
  割: "ge",
  贯: "guan",
  殊: "shu",
  释: "shi",
  词: "ci",
  亡: "wang",
  壁: "bi",
  顿: "dun",
  宝: "bao",
  午: "wu",
  尘: "chen",
  闻: "wen",
  揭: "jie",
  炮: "pao",
  残: "can",
  冬: "dong",
  桥: "qiao",
  妇: "fu",
  警: "jing",
  综: "zong",
  招: "zhao",
  吴: "wu",
  付: "fu",
  浮: "fu",
  遭: "zao",
  徐: "xu",
  您: "nin",
  摇: "yao",
  谷: "gu",
  赞: "zan",
  箱: "xiang",
  隔: "ge",
  订: "ding",
  男: "nan",
  吹: "chui",
  园: "yuan",
  纷: "fen",
  唐: "tang",
  败: "bai",
  宋: "song",
  玻: "bo",
  巨: "ju",
  耕: "geng",
  坦: "tan",
  荣: "rong",
  闭: "bi",
  湾: "wan",
  键: "jian",
  凡: "fan",
  驻: "zhu",
  锅: "guo",
  救: "jiu",
  恩: "en",
  剥: "bo",
  凝: "ning",
  碱: "jian",
  齿: "chi",
  截: "jie",
  炼: "lian",
  麻: "ma",
  纺: "fang",
  禁: "jin",
  废: "fei",
  盛: "sheng",
  版: "ban",
  缓: "huan",
  净: "jing",
  睛: "jing",
  昌: "chang",
  婚: "hun",
  涉: "she",
  筒: "tong",
  嘴: "zui",
  插: "cha",
  岸: "an",
  朗: "lang",
  庄: "zhuang",
  街: "jie",
  藏: "cang",
  姑: "gu",
  贸: "mao",
  腐: "fu",
  奴: "nu",
  啦: "la",
  惯: "guan",
  乘: "cheng",
  伙: "huo",
  恢: "hui",
  匀: "yun",
  纱: "sha",
  扎: "zha",
  辩: "bian",
  耳: "er",
  彪: "biao",
  臣: "chen",
  亿: "yi",
  璃: "li",
  抵: "di",
  脉: "mai",
  秀: "xiu",
  萨: "sa",
  俄: "e",
  网: "wang",
  舞: "wu",
  店: "dian",
  喷: "pen",
  纵: "zong",
  寸: "cun",
  汗: "han",
  挂: "gua",
  洪: "hong",
  贺: "he",
  闪: "shan",
  柬: "jian",
  爆: "bao",
  烯: "xi",
  津: "jin",
  稻: "dao",
  墙: "qiang",
  软: "ruan",
  勇: "yong",
  像: "xiang",
  滚: "gun",
  厘: "li",
  蒙: "meng",
  芳: "fang",
  肯: "ken",
  坡: "po",
  柱: "zhu",
  荡: "dang",
  腿: "tui",
  仪: "yi",
  旅: "lv",
  尾: "wei",
  轧: "zha",
  冰: "bing",
  贡: "gong",
  登: "deng",
  黎: "li",
  削: "xue",
  钻: "zuan",
  勒: "le",
  逃: "tao",
  障: "zhang",
  氨: "an",
  郭: "guo",
  峰: "feng",
  币: "bi",
  港: "gang",
  伏: "fu",
  轨: "gui",
  亩: "mu",
  毕: "bi",
  擦: "ca",
  莫: "mo",
  刺: "ci",
  浪: "lang",
  秘: "mi",
  援: "yuan",
  株: "zhu",
  健: "jian",
  售: "shou",
  股: "gu",
  岛: "dao",
  甘: "gan",
  泡: "pao",
  睡: "shui",
  童: "tong",
  铸: "zhu",
  汤: "tang",
  阀: "fa",
  休: "xiu",
  汇: "hui",
  舍: "she",
  牧: "mu",
  绕: "rao",
  炸: "zha",
  哲: "zhe",
  磷: "lin",
  绩: "ji",
  朋: "peng",
  淡: "dan",
  尖: "jian",
  启: "qi",
  陷: "xian",
  柴: "chai",
  呈: "cheng",
  徒: "tu",
  颜: "yan",
  泪: "lei",
  稍: "shao",
  忘: "wang",
  泵: "beng",
  蓝: "lan",
  拖: "tuo",
  洞: "dong",
  授: "shou",
  镜: "jing",
  辛: "xin",
  壮: "zhuang",
  锋: "feng",
  贫: "pin",
  虚: "xu",
  弯: "wan",
  摩: "mo",
  泰: "tai",
  幼: "you",
  廷: "ting",
  尊: "zun",
  窗: "chuang",
  纲: "gang",
  弄: "nong",
  隶: "li",
  疑: "yi",
  氏: "shi",
  宫: "gong",
  姐: "jie",
  震: "zhen",
  瑞: "rui",
  怪: "guai",
  尤: "you",
  琴: "qin",
  循: "xun",
  描: "miao",
  膜: "mo",
  违: "wei",
  夹: "jia",
  腰: "yao",
  缘: "yuan",
  珠: "zhu",
  穷: "qiong",
  森: "sen",
  枝: "zhi",
  竹: "zhu",
  沟: "gou",
  催: "cui",
  绳: "sheng",
  忆: "yi",
  邦: "bang",
  剩: "sheng",
  幸: "xing",
  浆: "jiang",
  栏: "lan",
  拥: "yong",
  牙: "ya",
  贮: "zhu",
  礼: "li",
  滤: "lv",
  钠: "na",
  纹: "wen",
  罢: "ba",
  拍: "pai",
  咱: "zan",
  喊: "han",
  袖: "xiu",
  埃: "ai",
  勤: "qin",
  罚: "fa",
  焦: "jiao",
  潜: "qian",
  伍: "wu",
  墨: "mo",
  欲: "yu",
  缝: "feng",
  姓: "xing",
  刊: "kan",
  饱: "bao",
  仿: "fang",
  奖: "jiang",
  铝: "lv",
  鬼: "gui",
  丽: "li",
  跨: "kua",
  默: "mo",
  挖: "wa",
  链: "lian",
  扫: "sao",
  喝: "he",
  袋: "dai",
  炭: "tan",
  污: "wu",
  幕: "mu",
  诸: "zhu",
  弧: "hu",
  励: "li",
  梅: "mei",
  奶: "nai",
  洁: "jie",
  灾: "zai",
  舟: "zhou",
  鉴: "jian",
  苯: "ben",
  讼: "song",
  抱: "bao",
  毁: "hui",
  懂: "dong",
  寒: "han",
  智: "zhi",
  埔: "pu",
  寄: "ji",
  届: "jie",
  跃: "yue",
  渡: "du",
  挑: "tiao",
  丹: "dan",
  艰: "jian",
  贝: "bei",
  碰: "peng",
  拔: "ba",
  爹: "die",
  戴: "dai",
  码: "ma",
  梦: "meng",
  芽: "ya",
  熔: "rong",
  赤: "chi",
  渔: "yu",
  哭: "ku",
  敬: "jing",
  颗: "ke",
  奔: "ben",
  铅: "qian",
  仲: "zhong",
  虎: "hu",
  稀: "xi",
  妹: "mei",
  乏: "fa",
  珍: "zhen",
  申: "shen",
  桌: "zhuo",
  遵: "zun",
  允: "yun",
  隆: "long",
  螺: "luo",
  仓: "cang",
  魏: "wei",
  锐: "rui",
  晓: "xiao",
  氮: "dan",
  兼: "jian",
  隐: "yin",
  碍: "ai",
  赫: "he",
  拨: "bo",
  忠: "zhong",
  肃: "su",
  缸: "gang",
  牵: "qian",
  抢: "qiang",
  博: "bo",
  巧: "qiao",
  壳: "ke",
  兄: "xiong",
  杜: "du",
  讯: "xun",
  诚: "cheng",
  碧: "bi",
  祥: "xiang",
  柯: "ke",
  页: "ye",
  巡: "xun",
  矩: "ju",
  悲: "bei",
  灌: "guan",
  龄: "ling",
  伦: "lun",
  票: "piao",
  寻: "xun",
  桂: "gui",
  铺: "pu",
  圣: "sheng",
  恐: "kong",
  恰: "qia",
  郑: "zheng",
  趣: "qu",
  抬: "tai",
  荒: "huang",
  腾: "teng",
  贴: "tie",
  柔: "rou",
  滴: "di",
  猛: "meng",
  阔: "kuo",
  辆: "liang",
  妻: "qi",
  填: "tian",
  撤: "che",
  储: "chu",
  签: "qian",
  闹: "nao",
  扰: "rao",
  紫: "zi",
  砂: "sha",
  递: "di",
  戏: "xi",
  吊: "diao",
  陶: "tao",
  伐: "fa",
  喂: "wei",
  疗: "liao",
  瓶: "ping",
  婆: "po",
  抚: "fu",
  臂: "bi",
  摸: "mo",
  忍: "ren",
  虾: "xia",
  蜡: "la",
  邻: "lin",
  胸: "xiong",
  巩: "gong",
  挤: "ji",
  偶: "ou",
  弃: "qi",
  槽: "cao",
  劲: "jin",
  乳: "ru",
  邓: "deng",
  吉: "ji",
  仁: "ren",
  烂: "lan",
  砖: "zhuan",
  租: "zu",
  乌: "wu",
  舰: "jian",
  伴: "ban",
  瓜: "gua",
  浅: "qian",
  丙: "bing",
  暂: "zan",
  燥: "zao",
  橡: "xiang",
  柳: "liu",
  迷: "mi",
  暖: "nuan",
  牌: "pai",
  秧: "yang",
  胆: "dan",
  详: "xiang",
  簧: "huang",
  踏: "ta",
  瓷: "ci",
  谱: "pu",
  呆: "dai",
  宾: "bin",
  糊: "hu",
  洛: "luo",
  辉: "hui",
  愤: "fen",
  竞: "jing",
  隙: "xi",
  怒: "nu",
  粘: "nian",
  乃: "nai",
  绪: "xu",
  肩: "jian",
  籍: "ji",
  敏: "min",
  涂: "tu",
  熙: "xi",
  皆: "jie",
  侦: "zhen",
  悬: "xuan",
  掘: "jue",
  享: "xiang",
  纠: "jiu",
  醒: "xing",
  狂: "kuang",
  锁: "suo",
  淀: "dian",
  恨: "hen",
  牲: "sheng",
  霸: "ba",
  爬: "pa",
  赏: "shang",
  逆: "ni",
  玩: "wan",
  陵: "ling",
  祝: "zhu",
  秒: "miao",
  浙: "zhe",
  貌: "mao",
  役: "yi",
  彼: "bi",
  悉: "xi",
  鸭: "ya",
  趋: "qu",
  凤: "feng",
  晨: "chen",
  畜: "chu",
  辈: "bei",
  秩: "zhi",
  卵: "luan",
  署: "shu",
  梯: "ti",
  炎: "yan",
  滩: "tan",
  棋: "qi",
  驱: "qu",
  筛: "shai",
  峡: "xia",
  冒: "mao",
  啥: "sha",
  寿: "shou",
  译: "yi",
  浸: "jin",
  泉: "quan",
  帽: "mao",
  迟: "chi",
  硅: "gui",
  疆: "jiang",
  贷: "dai",
  漏: "lou",
  稿: "gao",
  冠: "guan",
  嫩: "nen",
  胁: "xie",
  芯: "xin",
  牢: "lao",
  叛: "pan",
  蚀: "shi",
  奥: "ao",
  鸣: "ming",
  岭: "ling",
  羊: "yang",
  凭: "ping",
  串: "chuan",
  塘: "tang",
  绘: "hui",
  酬: "chou",
  滞: "zhi",
}

/**
 * 将中文字符转换为拼音（基于简单映射）
 */
function chineseToPinyin(text: string): string {
  return text
    .split("")
    .map((char) => pinyinMap[char] || char)
    .join("")
}

/**
 * 生成 URL 友好的 slug
 */
export function createSlug(text: string, options: SlugOptions = {}): string {
  const { maxLength = 50, separator = "-", lowercase = true, strict = false } = options

  if (!text || typeof text !== "string") {
    return ""
  }

  let slug = text.trim()

  // 首先处理空格，为中文字符间添加空格分隔
  slug = slug.replace(/([\u4e00-\u9fa5])/g, " $1 ")

  // 转换中文为拼音
  slug = chineseToPinyin(slug)

  // 转换为小写
  if (lowercase) {
    slug = slug.toLowerCase()
  }

  // 移除或替换特殊字符
  if (strict) {
    // 严格模式：只保留字母数字和分隔符
    slug = slug.replace(/[^a-zA-Z0-9\s\-_]/g, "")
  } else {
    // 宽松模式：替换常见特殊字符
    slug = slug
      .replace(/[&]/g, "and")
      .replace(/[+]/g, "plus")
      .replace(/[@]/g, "at")
      .replace(/[%]/g, "percent")
      .replace(/[#]/g, "hash")
      .replace(/[!]/g, "exclamation")
      .replace(/[?]/g, "question")
      .replace(/['"]/g, "")
      .replace(/[()]/g, "")
      .replace(/[[\]]/g, "")
      .replace(/[{}]/g, "")
      .replace(/[<>]/g, "")
  }

  // 将空格和下划线转换为分隔符
  slug = slug.replace(/[\s_]+/g, separator)

  // 移除多余的分隔符
  slug = slug
    .replace(
      new RegExp(`[${separator.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")}]+`, "g"),
      separator
    )
    .replace(new RegExp(`^[${separator.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")}]+`), "")
    .replace(new RegExp(`[${separator.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")}]+$`), "")

  // 限制长度
  if (slug.length > maxLength) {
    // 在分隔符处截断，避免截断单词
    const truncated = slug.substring(0, maxLength)
    const lastSeparatorIndex = truncated.lastIndexOf(separator)

    slug = lastSeparatorIndex > 0 ? truncated.substring(0, lastSeparatorIndex) : truncated
  }

  return slug
}

/**
 * 生成唯一的 slug（带去重逻辑）
 */
export async function createUniqueSlug(
  text: string,
  checkExists: (slug: string) => Promise<boolean>,
  options: SlugOptions = {}
): Promise<string> {
  const baseSlug = createSlug(text, options)

  if (!baseSlug) {
    throw new Error("无法生成有效的 slug")
  }

  let slug = baseSlug
  let counter = 0

  // 检查是否已存在，如果存在则添加数字后缀
  while (await checkExists(slug)) {
    counter++
    slug = `${baseSlug}-${counter}`
  }

  return slug
}

/**
 * 从 slug 还原为标题（仅供参考）
 */
export function slugToTitle(slug: string, separator: string = "-"): string {
  if (!slug || typeof slug !== "string") {
    return ""
  }

  return slug
    .split(separator)
    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
    .join(" ")
}

/**
 * 验证 slug 格式
 */
export function validateSlug(slug: string): {
  isValid: boolean
  errors: string[]
} {
  const errors: string[] = []

  if (!slug || typeof slug !== "string") {
    errors.push("Slug 不能为空")
    return { isValid: false, errors }
  }

  // 基本格式检查
  if (slug !== slug.trim()) {
    errors.push("Slug 不能包含首尾空格")
  }

  if (slug.length < 1) {
    errors.push("Slug 长度不能少于1个字符")
  }

  if (slug.length > 100) {
    errors.push("Slug 长度不能超过100个字符")
  }

  // URL 安全性检查
  if (!/^[a-zA-Z0-9\-_]+$/.test(slug)) {
    errors.push("Slug 只能包含字母、数字、连字符和下划线")
  }

  // 不能以分隔符开头或结尾
  if (/^[-_]|[-_]$/.test(slug)) {
    errors.push("Slug 不能以连字符或下划线开头或结尾")
  }

  // 不能包含连续的分隔符
  if (/[-_]{2,}/.test(slug)) {
    errors.push("Slug 不能包含连续的分隔符")
  }

  return {
    isValid: errors.length === 0,
    errors,
  }
}

/**
 * 批量生成唯一 slug
 */
export async function createUniqueSlugs(
  texts: string[],
  checkExists: (slug: string) => Promise<boolean>,
  options: SlugOptions = {}
): Promise<string[]> {
  const results: string[] = []
  const usedSlugs = new Set<string>()

  for (const text of texts) {
    const baseSlug = createSlug(text, options)

    if (!baseSlug) {
      throw new Error(`无法为文本 "${text}" 生成有效的 slug`)
    }

    let slug = baseSlug
    let counter = 0

    // 检查是否已存在于数据库或当前批次中
    while ((await checkExists(slug)) || usedSlugs.has(slug)) {
      counter++
      slug = `${baseSlug}-${counter}`
    }

    usedSlugs.add(slug)
    results.push(slug)
  }

  return results
}
